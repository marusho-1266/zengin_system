# å…¨éŠ€å”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œãƒ‡ãƒ¼ã‚¿ä½œæˆã‚·ã‚¹ãƒ†ãƒ  ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸

**ä½œæˆæ—¥**: 2025å¹´6æœˆ21æ—¥  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡**: /src ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ8ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹**: æ­£ç¢ºæ€§ãƒ»å¯èª­æ€§ãƒ»ä¿å®ˆæ€§ãƒ»æ€§èƒ½ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ Google Apps Script (GAS) ã§å®Ÿè£…ã•ã‚ŒãŸå…¨éŠ€å”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚åŸºæœ¬æ©Ÿèƒ½ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ãŒã€**æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨ã«ã¯æ€§èƒ½æ”¹å–„ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ãŒå¿…é ˆ**ã§ã™ã€‚

### ç·åˆè©•ä¾¡
- **æ©Ÿèƒ½å®Œæˆåº¦**: â˜…â˜…â˜…â˜…â˜† (4/5)
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: â˜…â˜…â˜…â˜†â˜† (3/5)
- **æ€§èƒ½**: â˜…â˜…â˜†â˜†â˜† (2/5)
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: â˜…â˜…â˜†â˜†â˜† (2/5)

## 1. æ­£ç¢ºæ€§ãƒ»ãƒã‚°æŠ‘æ­¢

### âœ… è‰¯ã„ç‚¹
- null/undefinedãƒã‚§ãƒƒã‚¯ãŒå„é–¢æ•°ã§é©åˆ‡ã«å®Ÿæ–½
- å¢ƒç•Œå€¤ãƒã‚§ãƒƒã‚¯ï¼ˆæ–‡å­—æ•°åˆ¶é™ã€æ•°å€¤ç¯„å›²ï¼‰ãŒå®šæ•°åŒ–ã•ã‚Œã¦ä¸€å…ƒç®¡ç†
- try-catchã«ã‚ˆã‚‹åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### âš ï¸ é‡å¤§ãªå•é¡Œç‚¹

#### 1.1 é‡‘é¡ã®å°æ•°ç‚¹å‡¦ç†ãŒä¸æ˜ç¢º
**ãƒ•ã‚¡ã‚¤ãƒ«**: `CsvProcessor.gs` (Line 550)
```javascript
// ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰
result[TRANSFER_DATA_COLUMNS.AMOUNT - 1] = amount ? parseFloat(amount) : '';

// å•é¡Œç‚¹: å…¨éŠ€å”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯æ•´æ•°ã®ã¿å¯¾å¿œ
// æ”¹å–„æ¡ˆ:
result[TRANSFER_DATA_COLUMNS.AMOUNT - 1] = amount ? Math.floor(parseFloat(amount)) : '';
```

#### 1.2 Shift_JISã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®æ¬ é™¥
**ãƒ•ã‚¡ã‚¤ãƒ«**: `ZenginFormat.gs` (Line 600-650)
```javascript
// ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰: é™å®šçš„ãªæ–‡å­—ãƒãƒƒãƒ”ãƒ³ã‚°ã®ã¿
function getShiftJISMapping(char) {
  const mappings = { /* ä¸€éƒ¨ã®æ–‡å­—ã®ã¿ */ };
  return mappings[char] || null; // å¤šãã®æ—¥æœ¬èªæ–‡å­—ãŒ '?' ã«ãªã‚‹
}

// æ”¹å–„æ¡ˆ: ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ç”¨ã¾ãŸã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‡¦ç†
```

#### 1.3 å‹å¤‰æ›ã®ä¸æ•´åˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `AutoComplete.gs` (Line 615)
```javascript
// æ•°å€¤å‹ãƒã‚§ãƒƒã‚¯ãŒä¸å®Œå…¨
if (typeof value === 'number') {
  return String(value).padStart(targetLength, '0');
}
// æ”¹å–„æ¡ˆ: ã‚ˆã‚Šå …ç‰¢ãªå‹ãƒã‚§ãƒƒã‚¯
```

## 2. å¯èª­æ€§ãƒ»ç†è§£å®¹æ˜“æ€§

### âœ… è‰¯ã„ç‚¹
- æ˜ç¢ºãªé–¢æ•°åã¨å½¹å‰²åˆ†æ‹…
- JSDocã‚³ãƒ¡ãƒ³ãƒˆã®å……å®Ÿ
- å®šæ•°ã®ä¸€å…ƒç®¡ç†ï¼ˆ`Constants.gs`ï¼‰

### âš ï¸ æ”¹å–„ãŒå¿…è¦ãªç‚¹

#### 2.1 å·¨å¤§é–¢æ•°ã®å­˜åœ¨
**å•é¡Œç®‡æ‰€**: 
- `bulkAutoComplete()` - 200è¡Œè¶…
- `importTransferDataFromCsv()` - 150è¡Œè¶…
- `showSystemSettings()` - 100è¡Œè¶…

**æ”¹å–„æ¡ˆ**:
```javascript
// é–¢æ•°ã‚’è²¬å‹™ã”ã¨ã«åˆ†å‰²
function bulkAutoComplete() {
  const validationResult = validateAutoCompleteData();
  const updateData = prepareUpdateData(validationResult);
  const result = executeAutoComplete(updateData);
  return formatAutoCompleteResult(result);
}
```

#### 2.2 æ·±ã„ãƒã‚¹ãƒˆæ§‹é€ 
æœ€å¤§ãƒã‚¹ãƒˆæ·±åº¦: 5ãƒ¬ãƒ™ãƒ«ï¼ˆ`CsvProcessor.gs`ï¼‰

## 3. ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§

### âš ï¸ é‡å¤§ãªå•é¡Œç‚¹

#### 3.1 é‡è¤‡ã‚³ãƒ¼ãƒ‰ã®å­˜åœ¨
åŒã˜æ­£è¦åŒ–å‡¦ç†ãŒè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«å­˜åœ¨:
- `AutoComplete.gs`: `normalizeCode()`
- `ZenginFormat.gs`: `normalizeNumericCode()`
- `Validation.gs`: é¡ä¼¼ã®å‡¦ç†

**æ”¹å–„æ¡ˆ**: å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã®ä½œæˆ
```javascript
// Utils.gs (æ–°è¦ä½œæˆ)
const Utils = {
  normalizeCode: function(value, length) {
    // çµ±ä¸€ã•ã‚ŒãŸæ­£è¦åŒ–å‡¦ç†
  },
  isEmptyRow: function(row) {
    // å…±é€šã®ç©ºè¡Œãƒã‚§ãƒƒã‚¯
  }
};
```

#### 3.2 ã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã®æ±šæŸ“
å…¨ã¦ã®é–¢æ•°ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹

**æ”¹å–„æ¡ˆ**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹é€ ã®å°å…¥
```javascript
const ZenginSystem = {
  Validation: {
    validateClientInfo: function() { ... },
    validateTransferData: function() { ... }
  },
  Format: {
    createZenginFile: function() { ... }
  },
  AutoComplete: {
    bulkAutoComplete: function() { ... }
  }
};
```

## 4. æ€§èƒ½ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

### âš ï¸ æ·±åˆ»ãªæ€§èƒ½å•é¡Œ

#### 4.1 éåŠ¹ç‡ãªã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ“ä½œ
**ç¾åœ¨ã®å®Ÿè£…**: 1ã‚»ãƒ«ãšã¤æ›´æ–°ï¼ˆéå¸¸ã«é…ã„ï¼‰
```javascript
// å•é¡Œã®ã‚³ãƒ¼ãƒ‰
updates.forEach(update => {
  sheet.getRange(update.row, update.col).setValue(update.value);
});
```

**æ”¹å–„æ¡ˆ**: ãƒãƒƒãƒæ›´æ–°
```javascript
// ä¸€æ‹¬æ›´æ–°ã§10å€ä»¥ä¸Šé«˜é€ŸåŒ–
const values = sheet.getRange(2, 1, lastRow-1, cols).getValues();
// ãƒ¡ãƒ¢ãƒªä¸Šã§æ›´æ–°å‡¦ç†
values.forEach((row, i) => {
  // æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯
});
// ä¸€æ‹¬æ›¸ãè¾¼ã¿
sheet.getRange(2, 1, values.length, cols).setValues(values);
```

#### 4.2 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœªæ´»ç”¨
`getBankMasterData()` ãŒæ¯å›å…¨ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿

**æ”¹å–„æ¡ˆ**:
```javascript
function getBankMasterDataWithCache() {
  const cache = CacheService.getScriptCache();
  const cached = cache.get('bankMasterData_v1');
  
  if (cached) {
    return JSON.parse(cached);
  }
  
  const data = loadBankMasterData();
  cache.put('bankMasterData_v1', JSON.stringify(data), 300); // 5åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  return data;
}
```

#### 4.3 éå‰°ãªãƒ­ã‚°å‡ºåŠ›
ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ãŒæœ¬ç•ªã§ã‚‚å‡ºåŠ›ã•ã‚Œã‚‹ï¼ˆæ€§èƒ½ä½ä¸‹ã®åŸå› ï¼‰

## 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯

#### 5.1 æ©Ÿå¯†æƒ…å ±ã®ãƒ­ã‚°å‡ºåŠ›
```javascript
// å•é¡Œ: å£åº§ç•ªå·ãªã©ãŒãƒ­ã‚°ã«è¨˜éŒ²
Logger.log(`è¡Œ${rowNum}: å£åº§ç•ªå·="${accountNumber}"`);

// æ”¹å–„æ¡ˆ: ãƒã‚¹ã‚­ãƒ³ã‚°å‡¦ç†
Logger.log(`è¡Œ${rowNum}: å£åº§ç•ªå·="${maskAccountNumber(accountNumber)}"`);

function maskAccountNumber(accountNumber) {
  if (!accountNumber || accountNumber.length < 4) return '****';
  return accountNumber.slice(0, 2) + '***' + accountNumber.slice(-2);
}
```

#### 5.2 XSSè„†å¼±æ€§ã®å¯èƒ½æ€§
HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…ã§ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ä¸è¶³

#### 5.3 ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®æ¬ å¦‚
- å…¨æ©Ÿèƒ½ãŒç„¡åˆ¶é™ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- å®Ÿè¡Œæ¨©é™ã®ãƒã‚§ãƒƒã‚¯ãªã—

## æ”¹å–„å„ªå…ˆé †ä½

### ğŸ”´ ç·Šæ€¥å¯¾å¿œï¼ˆãƒã‚°ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰
1. **Shift_JISã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ä¿®æ­£**
   - å½±éŸ¿: ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã®æ–‡å­—åŒ–ã‘
   - å·¥æ•°: ä¸­ï¼ˆ8æ™‚é–“ï¼‰
   
2. **æ©Ÿå¯†æƒ…å ±ã®ãƒ­ã‚°ãƒã‚¹ã‚­ãƒ³ã‚°**
   - å½±éŸ¿: æƒ…å ±æ¼æ´©ãƒªã‚¹ã‚¯
   - å·¥æ•°: å°ï¼ˆ4æ™‚é–“ï¼‰
   
3. **é‡‘é¡ã®æ•´æ•°å‡¦ç†æ˜ç¢ºåŒ–**
   - å½±éŸ¿: è¨ˆç®—èª¤å·®
   - å·¥æ•°: å°ï¼ˆ2æ™‚é–“ï¼‰

### ğŸŸ¡ é‡è¦å¯¾å¿œï¼ˆæ€§èƒ½ï¼‰
1. **ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ“ä½œã®ãƒãƒƒãƒåŒ–**
   - åŠ¹æœ: å‡¦ç†é€Ÿåº¦10å€ä»¥ä¸Šæ”¹å–„
   - å·¥æ•°: ä¸­ï¼ˆ8æ™‚é–“ï¼‰
   
2. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã®å®Ÿè£…**
   - åŠ¹æœ: ãƒ¬ã‚¹ãƒãƒ³ã‚¹50%æ”¹å–„
   - å·¥æ•°: å°ï¼ˆ4æ™‚é–“ï¼‰
   
3. **éå‰°ãªãƒ­ã‚°å‡ºåŠ›ã®å‰Šæ¸›**
   - åŠ¹æœ: å‡¦ç†é€Ÿåº¦20%æ”¹å–„
   - å·¥æ•°: å°ï¼ˆ2æ™‚é–“ï¼‰

### ğŸŸ¢ æ¨å¥¨å¯¾å¿œï¼ˆä¿å®ˆæ€§ï¼‰
1. **é‡è¤‡ã‚³ãƒ¼ãƒ‰ã®çµ±åˆ**
   - åŠ¹æœ: ä¿å®ˆæ€§å‘ä¸Š
   - å·¥æ•°: ä¸­ï¼ˆ6æ™‚é–“ï¼‰
   
2. **å·¨å¤§é–¢æ•°ã®åˆ†å‰²**
   - åŠ¹æœ: å¯èª­æ€§å‘ä¸Š
   - å·¥æ•°: ä¸­ï¼ˆ8æ™‚é–“ï¼‰
   
3. **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹é€ ã®å°å…¥**
   - åŠ¹æœ: æ‹¡å¼µæ€§å‘ä¸Š
   - å·¥æ•°: å¤§ï¼ˆ16æ™‚é–“ï¼‰

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³

### Phase 1ï¼ˆ1é€±é–“ï¼‰- ç·Šæ€¥å¯¾å¿œ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã®ä¿®æ­£
- [ ] é‡å¤§ãƒã‚°ã®ä¿®æ­£
- [ ] æ€§èƒ½æ¸¬å®šãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ç¢ºç«‹

### Phase 2ï¼ˆ2é€±é–“ï¼‰- æ€§èƒ½æ”¹å–„
- [ ] ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ“ä½œã®æœ€é©åŒ–
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] ãƒ­ã‚°å‡ºåŠ›ã®æœ€é©åŒ–

### Phase 3ï¼ˆ3é€±é–“ï¼‰- æ§‹é€ æ”¹å–„
- [ ] ã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- [ ] ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®è¿½åŠ 
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°

## çµè«–

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯åŸºæœ¬æ©Ÿèƒ½ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ãŒã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç’°å¢ƒã§ã®ä½¿ç”¨ã«ã¯æ”¹å–„ãŒå¿…è¦ã§ã™ã€‚ç‰¹ã«**æ€§èƒ½ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ”¹å–„ã¯å¿…é ˆ**ã§ã‚ã‚Šã€æ—©æ€¥ãªå¯¾å¿œã‚’æ¨å¥¨ã—ã¾ã™ã€‚

æ”¹å–„å¾Œã¯ä»¥ä¸‹ã®åŠ¹æœãŒæœŸå¾…ã§ãã¾ã™ï¼š
- **å‡¦ç†é€Ÿåº¦**: 10å€ä»¥ä¸Šã®é«˜é€ŸåŒ–
- **ä¿å®ˆæ€§**: 50%ã®å·¥æ•°å‰Šæ¸›
- **ä¿¡é ¼æ€§**: ãƒã‚°ç™ºç”Ÿç‡80%å‰Šæ¸›

---
**ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½è€…**: AIã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ   
**ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰‹æ³•**: é™çš„è§£æ + ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹è©•ä¾¡ 